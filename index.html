<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Migrating the WordPress Community from Slack to Matrix</title>
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/moon.css">
	<style>
		:root {
			--r-heading1-size: 3em;
		}
		object {
			fill: var( --r-background-color );
			background: var( --r-background-color );
		}
		.reveal ul {
			margin-left: 0;
			padding-left: 0;
		}
		ul li {
			margin-bottom: .5em;
			list-style-type: none;
		}
		li ul li {
			margin-bottom: .2em;
			list-style-type: "- ";
		}
		table.contact {
			margin-top: .5em;
		}
		table.contact tr td, table.contact tr td a {
			color: var( --r-main-color );
		}
		table.contact tr td {
			font-size: 90%;
			border-bottom: 0;
		}
		a:link {
			text-decoration: underline;
		}
		a.normal:link, a.normal:active, a.normal:visited {
			color: var( --r-main-color );
		}
		a.normal:hover {
			color: var( --r-link-color );
		}
		.small {
			font-size: 80%;
		}
		tt {
			border-radius: 4px;
			border: 1px solid #666;
			padding: 2px 6px;
		}
	</style>
</head>
<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h3>Migrating the</h3>
				<h1>WordPress Community from Slack to Matrix</h1>
				<div style="font-size: .5em; margin-top: 1em">
					<img src="img/alex.kirk.jpg" width="128" alt="Alex Kirk" style="border-radius: 64px"/><br/>
					Alex Kirk
					<table class="contact">
						<tr><td>Blog</td><td><a href="https://alex.kirk.at/">https://alex.kirk.at/</a></td></tr>
						<tr><td>Matrix</td><td>@alex:kirk.at</td></tr>
						<tr><td>ActivityPub</td><td>@alex@kirk.at</td></tr>
					</table>
				</div>
			</section>

			<section>
				<h2>Alex Kirk</h2>
				<ul>
					<li>From Vienna, Austria (ich spreche auch deutsch)</li>
					<li>At <a href="https://automattic.com/">Automattic</a> since 2014
						<ul>
							<li>Engineer, leading teams around Localization &amp; Matrix</li>
							<li>Sponsored to contribute to WordPress.org in Meta and Polyglots</li>
						</ul>
					</li>
					<li>Also working in the ActivityPub field, see my <a href="https://wordpress.org/plugins/friends/">Friends plugin</a><br><span style="font-size: 80%">Your WordPress can be your personal Mastodon instance with a nice address</span></li>
				</ul>
			</section>

			<section>
				<h2>What is WordPress?</h2>
				<ul>
					<li>A popular PHP CMS for websites and blogs, started in 2003</li>
					<li class="fragment">Today it powers <a href="https://w3techs.com/technologies/details/cm-wordpress">over 43% of all websites</a> on the internet</li>
					<li class="fragment">Features a <a href="https://github.com/WordPress/gutenberg">block editor</a> to edit posts and themes</li>
					<li class="fragment">Well known for <a href="https://wordpress.org/plugins/">plugins</a> like<br/>Yoast SEO, Advanced Custom Fields, WooCommerce</li>
					<li class="fragment"><a href="https://developer.wordpress.org/themes/getting-started/wordpress-licensing-the-gpl/">Open Source under the GPL</a></li>
				</ul>
			</section>

			<section>
				<h2>How the WordPress project works</h2>
				<p><a href="https://make.wordpress.org/">https://make.wordpress.org/</a></p>

				<ul>
					<li></li>
					<li class="fragment">20 "Make teams": Accessibility, Core, Design, Polyglots, ...</li>
					<li class="fragment">Each team has a P2 (blog) for
						<ul>
							<li>Announcements</li>
							<li>Proposals</li>
							<li>Meeting summaries</li>
							<li>Documentation (handbooks)</li>
						</ul>
					</li>
					<li class="fragment">WordCamps: <a href="https://europe.wordcamp.org/">EU</a>, <a href="https://asia.wordcamp.org/">Asia</a>, <a href="https://us.wordcamp.org/">US</a>, <a href="https://germany.wordcamp.org/">Germany</a> (soon: Oct 19-22), <a href="https://central.wordcamp.org/">...</a></li>
				</ul>
			</section>

			<section>
				<h2>Five for the Future</h2>
				<p><a href="https://wordpress.org/five-for-the-future/">https://wordpress.org/five-for-the-future/</a></p>
				<ul>
					<li class="fragment">Companies and individuals <a href="https://wordpress.org/five-for-the-future/pledges/">pledge to give 5%</a> of time or resources</li>
					<li class="fragment">A 100-people company would sponsor 5 people full time</li>
					<li class="fragment">Individuals: 2hrs / week</li>
					<li class="fragment">→ Many people from different companies collaborate</li>
				</ul>
			</section>

			<section>
				<h2>Contributors to WP6.2 by Company</h2>
				<object data="img/WP62-company-contributors.svg" type="image/svg+xml"  width="1000" height="500"></object>
				<p style="font-size: 10px"><a href="https://jeanbaptisteaudras.com/2023/04/contribution-stats-for-wordpress-6-2-dolphy/">https://jeanbaptisteaudras.com/2023/04/contribution-stats-for-wordpress-6-2-dolphy/</a></p>
			</section>

			<section>
				<h2>How Open Source works at WordPress</h2>
				<ul>
					<li>Issues are logged in Trac or Github</li>
					<li class="fragment">We have multiple trackers, e.g. <a href="https://core.trac.wordpress.org/">Core</a>, <a href="https://meta.trac.wordpress.org/">Meta</a>, <a href="https://github.com/WordPress/gutenberg/issues">Gutenberg</a></li>
					<li class="fragment">Discussions and status updates happen in tickets</li>
					<li class="fragment">In (bi-)weekly meetings, the contributors coordinate, share news, scrub bugs, etc.</li>
					<li class="fragment"><a href="https://make.wordpress.org/meetings/">These meetings</a> give everyone a chance to bring issues forward and discuss them with project participants</li>
				</ul>
			</section>

			<section>
				<a href="https://make.wordpress.org/">https://make.wordpress.org/</a><br/>
				<img src="img/make-wordpress-org.png" alt="Overview of the Making WordPress.org teams including meeting times" />
			</section>

			<section>
				<a href="https://make.wordpress.org/meetings/">https://make.wordpress.org/meetings/</a><br/>
				<img src="img/make-wordpress-org-meetings.png" alt="Calendar view of the WordPress.org community meetings" />
			</section>

			<section>
				<h2>Why migrate away from Slack?</h2>
				<ul>
					<li class="fragment">Slack was not designed for an open source community
						<ul>
							<li>Sign up is E-Mail domain based → <tt>@chat.wordpress.org</tt></li>
							<li>E-Mail forwarding needed so that people receive their invite</li>
						</ul>
					</li>
					<li class="fragment">Non-Open Source chat for an Open Source project</li>
				</ul>
			</section>

			<section>
				<h2>Slack &amp; an open source community</h2>
				<ul>
					<li class="fragment">Complexity through E-Mail-based signup with invites</li>
					<li class="fragment">Common issue at WordCamps where we onboard new people<br/><a href="https://make.wordpress.org/chat/">Full page of instructions</a> → people won’t read it</li>
					<li class="fragment">Message retention
						<ul>
							<li>10,000 / 90 days message history limit for free plans</li>
						</ul>
					</li>
					<li class="fragment">Data is siloed behind Slack’s doors</li>
				</ul>
			</section>

			<section>
				<h2>Matrix &amp; an open source community</h2>
				<ul>
					<li class="fragment">Federation has been designed so that anyone can join</li>
					<li class="fragment">Login via existing authentication system (SSO / OIDC)</li>
					<li class="fragment">No retention limits</li>
					<li class="fragment">Unite several Slack workspaces (e.g. for local communities)</li>
					<li class="fragment">Open Source chat for an Open Source project</li>
				</ul>
			</section>

			<section>
				<h2>Matrix is still behind on</h2>
				<ul>
					<li>Element's UX
						<ul>
							<li class="fragment">Notification Management
								<ul>
									<li class="fragment">No dedicated threads and mentions view</li>
									<li class="fragment">Cannot mark message as unread</li>
								</ul>
							</li>
							<li class="fragment">Search: No filters, icon looks like it's in-room search only</li>
							<li class="fragment">Joining room experience (need click an "add" icon to join)</li>
						</ul>
					</li>
					<li class="fragment">Other clients miss important features like threads</li>
					<li class="fragment">Access Control for server users: Anyone can create a new room<br/><small>(we know about  Matrix Corporal but we didn't yet dive into it)</small></li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h2>Making it easier to join Matrix</h2>
				<p><a href="https://github.com/Automattic/chatrix">Chatrix</a>: Matrix client in a WordPress block</p>
				<ul>
					<li class="fragment">Each block can be configured individually</li>
					<li class="fragment">Set a home server, can be restricted to a single room</li>
					<li class="fragment">Based on Hydrogen with upstream contributions:
						<ul>
							<li><a href="https://github.com/vector-im/hydrogen-web/pull/1056">Webworkers for Sync</a> to allow multiple Hydrogens open in a single browser → multiple Chatrix blocks on the same page</li>
							<li><a href="https://github.com/vector-im/hydrogen-web/pulls?q=is%3Apr+author%3Apsrpinto">multiple bugfixes</a> around SSO and workers</li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<a href="https://make.wordpress.org/polyglots/chat/">https://make.wordpress.org/polyglots/chat/</a><br/>
				<img src="img/make-wordpress-org-polyglots-chat.png" alt="Making WordPress Polyglots Team chat page" />
			</section>


			<section>
				<p>Creating a new post with a Chatrix block</p>
				<video data-autoplay data-src="img/create-chatrix-page.mp4" type="video/mp4" alt="An animatied gif showing how to create a post with a Chatrix block"></video>
			</section>

			<section>
				<h2>Making it easier to join Matrix</h2>
				<p><a href="https://github.com/Automattic/wp-openid-connect-server">OpenID Connect Server</a> WordPress plugin</p>
				<ul>
					<li class="fragment">Makes your WordPress an OIDC provider</li>
					<li class="fragment">→ WordPress.org users can login with their account</li>
				</ul>
				<img src="img/authorize-matrix.png" alt="" height="300">
			</section>

			<section>
				<h2>Making it easier to join Matrix</h2>
				<p>We host <a href="https://matrix.wordpress.net/">a preconfigured Element Web</a></p>

				<img src="img/matrix-wordpress-net.png" alt="" height="500">
			</section>

			<section>
				<h2>Making the Migration easier with a bridge</h2>
				<ul>
					<li class="fragment">Created the users on the homeserver with a script</li>
					<li class="fragment">Slack bridge
						<ul>
							<li>We’re using a <a href="http://github.com/Automattic/matrix-appservice-slack">forked version</a> of matrix-appservice-slack
								<ul>
									<li><a href="https://github.com/matrix-org/matrix-appservice-slack/pulls/psrpinto">Upstream fixes</a> waiting to be merged :)</li>
								</ul>
							</li>
							<li class="fragment">Extended the bridge to puppet users on the Matrix side since we know the users exist</li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h2>Migrating history seamlessly</h2>
				<ol>
					<li class="fragment">Create room and bridge it (it won't have history)</li>
					<li class="fragment">Create a second room and migrate the history there
						<ul>
							<li class="fragment">Add all users who are in the room in Slack</li>
							<li class="fragment">Import in sequence, backdating events (appservice)</li>
							<li class="fragment">If a user is no longer in the room, we re-invite them</li>
						</ul>
					</li>
					<li class="fragment">Copy events from the first room to catch up with real-time</li>
					<li class="fragment">Change room aliases, reattach bridge, delete old room</li>
				</ol>
			</section>

			<section>
				<h2>Matrix Server</h2>
				<p><tt><a href="https://community.wordpress.org">community.wordpress.org</a></tt></p>
				<ul>
					<li>Synapse
						<ul>
							<li>Slack bridge</li>
							<li>OpenID connect configured</li>
							<li>Migration appservice</li>
						</ul>
					</li>
					<li class="fragment">We migrated
						<ul>
							<li>~ 3m messages in ~170 rooms</li>
							<li>~ 45k users</li>
							<li>~ 55GB database size</li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h2>Still missing: App migration</h2>
				<ul>
					<li class="fragment">Simple apps can be used from Matrix through the Slack bridge</li>
					<li class="fragment">Ecosystem problem
						<ul>
							<li>Companies build Slack apps using internal APIs<br/>→ Cannot replicate on Matrix</li>
							<li>Need to evaluate each Slack app and find a specific solution</li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h2>Misc Tips</h2>
				<ul>
					<li class="fragment">Temorarily turn off the <tt>push</tt> setting in Synapse while importing
						<ul>
							<li class="fragment">Our first import of a room resulted in a db size of 257 GB for a Slack channel with 2.5k users and 90k messages</li>
						</ul>
					</li>
					<li class="fragment">OIDC: Synapse queries the <tt>userinfo</tt> endpoint even for a JWT</li>
					<li class="fragment">Serve something useful on the homeserver address HTTPS URL
						<ul>
							<li>People will enter it in their browser</li>
							<li class="fragment">Redirect it to your <a href="https://make.wordpress.org/chat/matrix/">Matrix onboarding guide</a></li>
						</ul>
					</li>
					<li class="fragment">Pick a server address that doesn't convey they represent the project</li>
				</ul>
			</section>

			<section>
				<h2>Trial Phase</h2>
				<ul>
					<li class="fragment"><a href="https://make.wordpress.org">Making WordPress</a> is not a Matrix-only community yet</li>
					<li class="fragment">Slack and Matrix work in parallel for now</li>
					<li class="fragment">Still inconclusive about community acceptance
						<ul>
							<li>Slack is widespread in WordPress-based companies</li>
							<li>More convenient to just have one chat client</li>
							<li class="fragment">Selling point: (individual) cross-org spaces</li>

						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h2>We're Hiring!</h2>
				<p>Automattic is hiring Matrix Engineers</p>
				<p>Ping me at <tt>@alex:kirk.at</tt></p>
			</section>

			<section>
				<h1>Thank You!</h1>
				<h2>Questions?</h2>
				<p><a href="https://alex.kirk.at/matrix-summit-2023/">https://alex.kirk.at/matrix-summit-2023/</a></p>
				<object data="img/qr-alex-kirk-at.svg" type="image/svg+xml"  width="200" height="200"></object>
			</section>
		</div>
	</div>
	<script src="dist/reveal.js"></script>
	<script src="dist/plugin/notes/notes.js"></script>
	<script>
		Reveal.initialize({
			controls: true,
			controlsTutorial: true,
			progress: true,
			hash: true,
			autoPlayMedia: true,
			slideNumber: 'c/t',
			width: 1200,
		}).then( () => {
		});
	</script>
</body>
</html>
